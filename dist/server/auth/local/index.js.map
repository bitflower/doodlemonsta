{"version":3,"sources":["auth/local/index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;uBAEO,SAAS;;;;wBACR,UAAU;;;;2BACL,iBAAiB;;AAE3C,IAAI,MAAM,GAAG,qBAAQ,MAAM,EAAE,CAAC;;AAE9B,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;;;;AAItC,0BAAS,YAAY,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE;;AAErD,YAAI,KAAK,GAAG,GAAG,IAAI,IAAI,CAAC;AACxB,YAAI,KAAK,EAAE;;AAEP,mBAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACtC;AACD,YAAI,CAAC,IAAI,EAAE;;AAEP,mBAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,yCAAyC,EAAE,CAAC,CAAC;SACvF;;;;AAID,YAAI,KAAK,GAAG,4BAAU,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;;;AAG3C,WAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAL,KAAK,EAAE,CAAC,CAAC;KAEvB,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;CACrB,CAAC,CAAC;;qBAEY,MAAM","file":"auth/local/index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport { signToken } from '../auth.service';\n\nvar router = express.Router();\n\nrouter.post('/', function(req, res, next) {\n\n    // console.log('Receiving login request: ', req.body); // OK !\n\n    passport.authenticate('local', function(err, user, info) {\n\n        var error = err || info;\n        if (error) {\n            // console.log('ERROR in strategy', error);\n            return res.status(401).json(error);\n        }\n        if (!user) {\n            // console.log('USER NOT FOUND');\n            return res.status(404).json({ message: 'Something went wrong, please try again.' });\n        }\n\n        // console.log('Trying to sign token'); OK !\n\n        var token = signToken(user._id, user.role);\n        // console.log('TOKEN', token); // OK !\n\n        res.json({ token });\n\n    })(req, res, next)\n});\n\nexport default router;\n"],"sourceRoot":"/source/"}